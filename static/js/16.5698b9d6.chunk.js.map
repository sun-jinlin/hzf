{"version":3,"sources":["api/User/index.js","page/Login/index.module.css","page/Login/index.js"],"names":["login","data","request","method","url","getUserInfo","logout","getFavorites","id","mothod","addFavorites","delFavorites","submitHouse","getUserHouses","module","exports","Login","this","props","values","errors","touched","handleChange","handleSubmit","handleBlur","className","styles","root","mode","size","onSubmit","formItem","value","username","onChange","input","name","placeholder","error","password","type","formSubmit","submit","backHome","Item","to","Component","NewLogin","withFormik","mapPropsToValues","validationSchema","yup","shape","required","matches","a","status","description","success","setToken","token","backUrl","location","history","replace","fail"],"mappings":"6FAAA,4RAKO,SAASA,EAAMC,GACpB,OAAOC,YAAQ,CACbC,OAAQ,OACRC,IAAK,cACLH,SAOG,SAASI,IACd,OAAOH,YAAQ,CACbC,OAAQ,MACRC,IAAK,UAOF,SAASE,IACd,OAAOJ,YAAQ,CACbC,OAAQ,OACRC,IAAK,iBAMF,SAASG,EAAaC,GAC3B,OAAON,YAAQ,CACbO,OAAQ,MACRL,IAAI,mBAAD,OAAqBI,KAMrB,SAASE,EAAaF,GAC3B,OAAON,YAAQ,CACbC,OAAQ,OACRC,IAAI,mBAAD,OAAqBI,KAMrB,SAASG,EAAaH,GAC3B,OAAON,YAAQ,CACbC,OAAQ,SACRC,IAAI,mBAAD,OAAqBI,KAMrB,SAASI,EAAYX,GAC1B,OAAOC,YAAQ,CACbC,OAAQ,OACRC,IAAK,eACLH,SAMG,SAASY,IACd,OAAOX,YAAQ,CACbC,OAAQ,MACRC,IAAK,mB,oBC1ETU,EAAOC,QAAU,CAAC,KAAO,oBAAoB,UAAY,yBAAyB,SAAW,wBAAwB,SAAW,wBAAwB,MAAQ,qBAAqB,WAAa,0BAA0B,OAAS,sBAAsB,MAAQ,uB,mTCmB7PC,E,4JACJ,WAAU,IAAD,EAQHC,KAAKC,MANPC,EAFK,EAELA,OAEAC,GAJK,EAGLC,QAHK,EAILD,QACAE,EALK,EAKLA,aAEAC,GAPK,EAMLC,WANK,EAOLD,cAEF,OACE,sBAAKE,UAAWC,IAAOC,KAAvB,UAEE,mBAAQC,KAAK,QAAb,sCAGA,mBAAYC,KAAK,OAGjB,8BACE,uBAAMC,SAAUP,EAAhB,UACE,qBAAKE,UAAWC,IAAOK,SAAvB,SACE,uBACEC,MAAOb,EAAOc,SACdC,SAAUZ,EACVG,UAAWC,IAAOS,MAClBC,KAAK,WACLC,YAAY,qCAIfjB,EAAOa,UAAY,qBAAKR,UAAWC,IAAOY,MAAvB,SAA+BlB,EAAOa,WAE1D,qBAAKR,UAAWC,IAAOK,SAAvB,SACE,uBACEC,MAAOb,EAAOoB,SACdL,SAAUZ,EACVG,UAAWC,IAAOS,MAClBC,KAAK,WACLI,KAAK,WACLH,YAAY,qCAIfjB,EAAOmB,UAAY,qBAAKd,UAAWC,IAAOY,MAAvB,SAA+BlB,EAAOmB,WAE1D,qBAAKd,UAAWC,IAAOe,WAAvB,SACE,wBAAQhB,UAAWC,IAAOgB,OAAQF,KAAK,SAAvC,gCAKJ,mBAAMf,UAAWC,IAAOiB,SAAxB,SACE,kBAAMC,KAAN,UACE,cAAC,IAAD,CAAMC,GAAG,WAAT,mF,GAtDMC,aA8DdC,EAAWC,YAAW,CAC1BC,iBAAkB,iBAAO,CACvBhB,SAAU,QACVM,SAAU,UAcZW,iBAAkBC,MAAaC,MAAM,CACnCnB,SAAUkB,MAAaE,SAAS,0DAAaC,QAnF/B,qBAmFkD,wHAChEf,SAAUY,MAAaE,SAAS,8CAAWC,QAnF/B,sBAmFgD,2HAG9D/B,aAAa,WAAD,4BAAE,WAAOJ,EAAP,8BAAAoC,EAAA,6DAAiBrC,EAAjB,EAAiBA,MACrBe,EAAuBd,EAAvBc,SAAUM,EAAapB,EAAboB,SADN,SAEgCvC,YAAM,CAAEiC,WAAUM,aAFlD,gBAEJiB,EAFI,EAEJA,OAAQvD,EAFJ,EAEIA,KAAMwD,EAFV,EAEUA,YACP,MAAXD,EACF,IAAME,QAAQD,EAAa,GAAG,WAC5BE,YAAS1D,EAAK2D,OACd,IAAMC,EAAU3C,EAAM4C,SAASD,QAC3BA,EACF3C,EAAM6C,QAAQC,QAAQH,GAEtB3C,EAAM6C,QAAQC,QAAQ,oBAK1B,IAAMC,KAAKR,GAfD,2CAAF,qDAAC,IAtBET,CAyCdhC,GAEY+B","file":"static/js/16.5698b9d6.chunk.js","sourcesContent":["// 获取axios\r\nimport request from '../../utils/request'\r\n\r\n\r\n// 用户登录接口\r\nexport function login(data) {\r\n  return request({\r\n    method: 'post',\r\n    url: '/user/login',\r\n    data\r\n  })\r\n}\r\n/**\r\n * 获取用户的信息资料\r\n * \r\n */\r\nexport function getUserInfo() {\r\n  return request({\r\n    method: 'get',\r\n    url: '/user',\r\n  })\r\n}\r\n/**\r\n * 登出\r\n * \r\n */\r\nexport function logout() {\r\n  return request({\r\n    method: 'post',\r\n    url: '/user/logout'\r\n  })\r\n}\r\n/**\r\n * 房屋是否收藏\r\n */\r\nexport function getFavorites(id) {\r\n  return request({\r\n    mothod: 'get',\r\n    url: `/user/favorites/${id}`\r\n  })\r\n}\r\n/**\r\n * 添加收藏\r\n */\r\nexport function addFavorites(id) {\r\n  return request({\r\n    method: 'post',\r\n    url: `/user/favorites/${id}`\r\n  })\r\n}\r\n/**\r\n * 取消收藏\r\n */\r\nexport function delFavorites(id) {\r\n  return request({\r\n    method: 'delete',\r\n    url: `/user/favorites/${id}`\r\n  })\r\n}\r\n/**\r\n *  发布房源\r\n */\r\nexport function submitHouse(data) {\r\n  return request({\r\n    method: 'post',\r\n    url: '/user/houses',\r\n    data\r\n  })\r\n}\r\n/**\r\n *  查看房源列表\r\n */\r\nexport function getUserHouses() {\r\n  return request({\r\n    method: 'get',\r\n    url: '/user/houses',\r\n  })\r\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Login_root__2y3FY\",\"navHeader\":\"Login_navHeader__1Vnzh\",\"backHome\":\"Login_backHome__-g2Ux\",\"formItem\":\"Login_formItem__X8Hzr\",\"input\":\"Login_input__1ZItE\",\"formSubmit\":\"Login_formSubmit__3Udxo\",\"submit\":\"Login_submit__3QPcE\",\"error\":\"Login_error__2kr43\"};","import React, { Component } from 'react'\r\nimport { Flex, WingBlank, WhiteSpace, NavBar, Toast } from 'antd-mobile'\r\n\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport styles from './index.module.css'\r\n\r\n// 引入withFormik高阶组件\r\nimport { withFormik } from 'formik';\r\n// 引入yup\r\nimport * as yup from 'yup';\r\n// 引入api\r\nimport { login } from '../../api/User';\r\n// 设置token\r\nimport { setToken } from '../../utils/method';\r\n\r\n// 验证规则：\r\nconst REG_UNAME = /^[a-zA-Z_\\d]{5,8}$/\r\nconst REG_PWD = /^[a-zA-Z_\\d]{5,12}$/\r\n\r\nclass Login extends Component {\r\n  render() {\r\n    const {\r\n      values,\r\n      touched,\r\n      errors,\r\n      handleChange,\r\n      handleBlur,\r\n      handleSubmit,\r\n    } = this.props;\r\n    return (\r\n      <div className={styles.root}>\r\n        {/* 顶部导航 */}\r\n        <NavBar mode=\"light\">\r\n          账号登录\r\n        </NavBar>\r\n        <WhiteSpace size=\"xl\" />\r\n\r\n        {/* 登录表单 */}\r\n        <WingBlank>\r\n          <form onSubmit={handleSubmit}>\r\n            <div className={styles.formItem}>\r\n              <input\r\n                value={values.username}\r\n                onChange={handleChange}\r\n                className={styles.input}\r\n                name=\"username\"\r\n                placeholder=\"请输入账号\"\r\n              />\r\n            </div>\r\n            {/* 长度为5到8位，只能出现数字、字母、下划线 */}\r\n            {errors.username && <div className={styles.error}>{errors.username}</div>}\r\n\r\n            <div className={styles.formItem}>\r\n              <input\r\n                value={values.password}\r\n                onChange={handleChange}\r\n                className={styles.input}\r\n                name=\"password\"\r\n                type=\"password\"\r\n                placeholder=\"请输入密码\"\r\n              />\r\n            </div>\r\n            {/* 长度为5到12位，只能出现数字、字母、下划线 */}\r\n            {errors.password && <div className={styles.error}>{errors.password}</div>}\r\n            {/* <div className={styles.error}>账号为必填项</div> */}\r\n            <div className={styles.formSubmit}>\r\n              <button className={styles.submit} type=\"submit\">\r\n                登 录\r\n              </button>\r\n            </div>\r\n          </form>\r\n          <Flex className={styles.backHome}>\r\n            <Flex.Item>\r\n              <Link to=\"/registe\">还没有账号，去注册~</Link>\r\n            </Flex.Item>\r\n          </Flex>\r\n        </WingBlank>\r\n      </div>\r\n    )\r\n  }\r\n}\r\nconst NewLogin = withFormik({\r\n  mapPropsToValues: () => ({\r\n    username: 'test2',\r\n    password: 'test2'\r\n  }),\r\n\r\n  // Custom sync validation\r\n  // validate: values => {\r\n  //   const errors = {};\r\n\r\n  //   if (!values.name) {\r\n  //     errors.name = 'Required';\r\n  //   }\r\n\r\n  //   return errors;\r\n  // },\r\n  // 表单验证\r\n  validationSchema: yup.object().shape({\r\n    username: yup.string().required('用户名称不能为空！').matches(REG_UNAME, '长度为5到8位，只能出现数字、字母、下划线'),\r\n    password: yup.string().required('密码不能为空！').matches(REG_PWD, '长度为5到12位，只能出现数字、字母、下划线'),\r\n  }),\r\n  // 登录按钮\r\n  handleSubmit: async (values, { props }) => {\r\n    const { username, password } = values;\r\n    const { status, data, description } = await login({ username, password })\r\n    if (status === 200) {\r\n      Toast.success(description, 1, () => {\r\n        setToken(data.token)\r\n        const backUrl = props.location.backUrl\r\n        if (backUrl) {\r\n          props.history.replace(backUrl)\r\n        } else {\r\n          props.history.replace('/home/profile')\r\n        }\r\n\r\n      })\r\n    } else {\r\n      Toast.fail(description)\r\n    }\r\n  },\r\n\r\n})(Login);\r\n\r\nexport default NewLogin\r\n"],"sourceRoot":""}