{"version":3,"sources":["../node_modules/antd-mobile/lib/nav-bar/style/css.js","../node_modules/antd-mobile/lib/nav-bar/index.js","page/CityList/index.jsx"],"names":["require","Object","defineProperty","exports","value","_extends3","_interopRequireDefault","_classCallCheck3","_createClass3","_possibleConstructorReturn3","_inherits3","_classnames2","React","obj","__esModule","newObj","key","prototype","hasOwnProperty","call","_interopRequireWildcard","__rest","s","e","t","p","indexOf","getOwnPropertySymbols","i","length","NavBar","_React$Component","this","__proto__","getPrototypeOf","apply","arguments","_a","props","prefixCls","className","children","mode","icon","onLeftClick","leftContent","rightContent","restProps","createElement","role","onClick","Component","defaultProps","module","CityList","state","cityIndex","cityList","activeCity","getCityList","a","status","data","formatCityData","getCityHot","Status","hot","unshift","getLocalCity","res","setState","forEach","item","firstCity","short","slice","push","keys","sort","formatKey","isTrue","toUpperCase","handelClick","includes","label","setStorage","history","goBack","info","rowRenderer","index","style","isScrolling","isVisible","k","map","rowHeight","renderCityIndex","ListKey","scrollToRow","onRowsRendered","overscanStartIndex","overscanStopIndex","startIndex","stopIndex","type","width","height","ref","ele","rowCount","scrollToAlignment"],"mappings":"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","file":"static/js/14.b043ce98.chunk.js","sourcesContent":["'use strict';\n\nrequire('../../style/css');\n\nrequire('./index.css');","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _react = require('react');\n\nvar React = _interopRequireWildcard(_react);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar __rest = undefined && undefined.__rest || function (s, e) {\n    var t = {};\n    for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n    }if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n        if (e.indexOf(p[i]) < 0) t[p[i]] = s[p[i]];\n    }return t;\n};\n\nvar NavBar = function (_React$Component) {\n    (0, _inherits3['default'])(NavBar, _React$Component);\n\n    function NavBar() {\n        (0, _classCallCheck3['default'])(this, NavBar);\n        return (0, _possibleConstructorReturn3['default'])(this, (NavBar.__proto__ || Object.getPrototypeOf(NavBar)).apply(this, arguments));\n    }\n\n    (0, _createClass3['default'])(NavBar, [{\n        key: 'render',\n        value: function render() {\n            var _a = this.props,\n                prefixCls = _a.prefixCls,\n                className = _a.className,\n                children = _a.children,\n                mode = _a.mode,\n                icon = _a.icon,\n                onLeftClick = _a.onLeftClick,\n                leftContent = _a.leftContent,\n                rightContent = _a.rightContent,\n                restProps = __rest(_a, [\"prefixCls\", \"className\", \"children\", \"mode\", \"icon\", \"onLeftClick\", \"leftContent\", \"rightContent\"]);\n            return React.createElement(\n                'div',\n                (0, _extends3['default'])({}, restProps, { className: (0, _classnames2['default'])(className, prefixCls, prefixCls + '-' + mode) }),\n                React.createElement(\n                    'div',\n                    { className: prefixCls + '-left', role: 'button', onClick: onLeftClick },\n                    icon ?\n                    // tslint:disable-next-line:jsx-no-multiline-js\n                    React.createElement(\n                        'span',\n                        { className: prefixCls + '-left-icon', 'aria-hidden': 'true' },\n                        icon\n                    ) : null,\n                    leftContent\n                ),\n                React.createElement(\n                    'div',\n                    { className: prefixCls + '-title' },\n                    children\n                ),\n                React.createElement(\n                    'div',\n                    { className: prefixCls + '-right' },\n                    rightContent\n                )\n            );\n        }\n    }]);\n    return NavBar;\n}(React.Component);\n\nexports['default'] = NavBar;\n\nNavBar.defaultProps = {\n    prefixCls: 'am-navbar',\n    mode: 'dark',\n    onLeftClick: function onLeftClick() {}\n};\nmodule.exports = exports['default'];","import React, { Component } from 'react';\r\n// 引入api\r\nimport { getCityList, getCityHot } from '../../api/City';\r\n// 引入获取当前城市方法\r\nimport { getLocalCity } from '../../utils/method'\r\n\r\n// 引入virtualized\r\nimport { AutoSizer, List } from 'react-virtualized';\r\n\r\n// 引入antd-mobile\r\nimport { NavBar, Icon, Toast } from 'antd-mobile';\r\n// 引入css\r\nimport './index.scss'\r\n\r\n// 引入sessionStorage\r\nimport { setStorage } from '../../utils/method'\r\n\r\n\r\n\r\n\r\n\r\nclass CityList extends Component {\r\n  state = {\r\n    cityIndex: [],\r\n    cityList: {},\r\n    activeCity: 0\r\n  }\r\n  componentDidMount() {\r\n    this.getCityList()\r\n  }\r\n  // 获取城市列表数据\r\n  getCityList = async () => {\r\n    const { status, data } = await getCityList()\r\n    if (status === 200) {\r\n      const { cityList, cityIndex } = this.formatCityData(data)\r\n      const { status: Status, data: hot } = await getCityHot()\r\n      if (Status === 200) {\r\n        cityIndex.unshift(\"hot\")\r\n        cityList['hot'] = hot\r\n        const res = await getLocalCity()\r\n        cityIndex.unshift(\"#\")\r\n        cityList['#'] = [res]\r\n        this.setState({ cityList, cityIndex })\r\n      }\r\n\r\n    }\r\n  }\r\n  // 格式化城市列表数据\r\n  formatCityData = (data) => {\r\n    let cityList = {}, cityIndex\r\n    data.forEach(item => {\r\n      let firstCity = item.short.slice(0, 1)\r\n      if (!(firstCity in cityList)) {\r\n        cityList[firstCity] = [item]\r\n      } else {\r\n        cityList[firstCity].push(item)\r\n      }\r\n    })\r\n    cityIndex = Object.keys(cityList).sort()\r\n    return { cityList, cityIndex }\r\n  }\r\n  // 格式化键\r\n  formatKey = (data, isTrue) => {\r\n    switch (data) {\r\n      case '#':\r\n        return isTrue ? '当' : '当前城市'\r\n      case 'hot':\r\n        return isTrue ? '热' : '热门城市'\r\n      default:\r\n        return data.toUpperCase()\r\n    }\r\n  }\r\n  // 点击城市\r\n  handelClick = (data) => {\r\n    const hasData = ['北京', '上海', '广州', '深圳'];\r\n    if (hasData.includes(data.label)) {\r\n      setStorage('CURR_CityList', data)\r\n      this.props.history.goBack()\r\n    } else {\r\n      Toast.info('所选城市没有房源，请换一换')\r\n    }\r\n  }\r\n  // 城市列表\r\n  rowRenderer = ({\r\n    key, // Unique key within array of rows\r\n    index, // Index of row within collection\r\n    isScrolling, // The List is currently being scrolled\r\n    isVisible, // This row is visible within the List (eg it is not an overscanned row)\r\n    style, // Style object to be applied to row (to position it)\r\n  }) => {\r\n    const { cityList, cityIndex } = this.state\r\n    const k = cityIndex[index]\r\n    return (\r\n      <div key={key} style={style} className=\"city-item\">\r\n        <div className=\"title\">{this.formatKey(k)}</div>\r\n        {cityList[k].map((item, i) => (\r\n          <div onClick={() => { this.handelClick(item) }} key={i} className=\"name\">{item.label}</div>\r\n        ))}\r\n\r\n      </div>\r\n    )\r\n  }\r\n  // 根据行自动获取行高\r\n  rowHeight = ({ index }) => {\r\n    const { cityList, cityIndex } = this.state\r\n    const k = cityIndex[index]\r\n    return 36 + 50 * cityList[k].length\r\n  }\r\n  // 城市索引\r\n  renderCityIndex = () => {\r\n    const { cityIndex } = this.state;\r\n    return cityIndex.map((item, index) => {\r\n      return (\r\n        <li\r\n          key={item}\r\n          className=\"city-index-item\"\r\n        >\r\n          <span onClick={() => {\r\n            this.ListKey.scrollToRow(index)\r\n          }} className={this.state.activeCity === index ? 'index-active' : ''}>\r\n            {this.formatKey(item, true)}\r\n          </span>\r\n        </li>\r\n      )\r\n    })\r\n  }\r\n  // 滚动屏幕索引联动\r\n  onRowsRendered = ({ overscanStartIndex, overscanStopIndex, startIndex, stopIndex }) => {\r\n    if (this.state.activeCity !== startIndex) {\r\n      this.setState({ activeCity: startIndex })\r\n    }\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"cityBox\">\r\n        {/* 导航栏 */}\r\n        <NavBar\r\n          mode=\"dark\"\r\n          icon={<Icon type=\"left\" />}\r\n          onLeftClick={() => this.props.history.goBack()}\r\n        >城市列表</NavBar>\r\n        {/* 城市列表 */}\r\n        <div className=\"citylist\">\r\n          <AutoSizer>\r\n            {({ width, height }) => (\r\n              < List\r\n                ref={(ele) => { this.ListKey = ele }}\r\n                width={width}\r\n                height={height}\r\n                rowCount={this.state.cityIndex.length}\r\n                rowHeight={this.rowHeight}\r\n                rowRenderer={this.rowRenderer}\r\n                scrollToAlignment=\"start\"\r\n                onRowsRendered={this.onRowsRendered}\r\n              />\r\n            )}\r\n          </AutoSizer>\r\n          {/* 右侧索引列表 */}\r\n          <ul className=\"city-index\">\r\n            {this.renderCityIndex()}\r\n          </ul>\r\n        </div>\r\n\r\n      </div >\r\n    )\r\n  }\r\n}\r\nexport default CityList"],"sourceRoot":""}